(()=>{var e={};e.id=6065,e.ids=[6065],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11735:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,z:()=>a});var s=r(96330);let a=global.prisma||new s.PrismaClient,n=a},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31830:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>w,serverHooks:()=>f,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{GET:()=>y});var a=r(96559),n=r(48088),o=r(37719),i=r(11735),u=r(77606),c=r(66445),d=r(95778),p=r(74526);async function l(){let e=(0,u.e)(new Date,30),t=(await i.z.inspection.findMany({where:{createdAt:{gte:(0,c.o)(e),lte:(0,d.D)(new Date)}},orderBy:{createdAt:"asc"}})).reduce((e,t)=>{let r=(0,p.GP)(t.createdAt,"yyyy-MM-dd");return e[r]=(e[r]||0)+1,e},{}),r=[];for(let e=0;e<30;e++){let s=(0,p.GP)((0,u.e)(new Date,30-e-1),"yyyy-MM-dd");r.push({date:s,count:t[s]||0})}return r}async function h(){(0,u.e)(new Date,30);let e=await i.z.inspection.count({where:{status:"INICIO"}}),t=await i.z.inspection.count({where:{status:"FINAL"}});return{finished:e,unfinished:t,total:e,finishedPercentage:(e>0?e/e*100:0).toFixed(2),unfinishedPercentage:(e>0?t/e*100:0).toFixed(2)}}var x=r(32190);async function y(){try{let e=await l(),t=await h();return x.NextResponse.json({inspectionsByDate:e,statusSummary:t})}catch(e){return console.error("Erro ao buscar inspe\xe7\xf5es recentes:",e),x.NextResponse.json({error:"Erro ao buscar dados de inspe\xe7\xf5es"},{status:500})}}let w=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/v2/dashboard/chart/lastMonth/route",pathname:"/api/v2/dashboard/chart/lastMonth",filename:"route",bundlePath:"app/api/v2/dashboard/chart/lastMonth/route"},resolvedPagePath:"C:\\Users\\carlos.dias\\Documents\\repositorio\\checklist\\src\\app\\api\\v2\\dashboard\\chart\\lastMonth\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:v,workUnitAsyncStorage:m,serverHooks:f}=w;function g(){return(0,o.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:m})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[80,6462],()=>r(31830));module.exports=s})();